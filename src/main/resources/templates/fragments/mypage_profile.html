<th:block xmlns:th="http://www.thymeleaf.org" th:fragment="mypage_profile">
    <div class="profile-menu collapse d-lg-block" id="profileMenu">
        <!-- User Info -->
        <div class="user-info" data-aos="fade-right">
            <h4 th:text="${member.memberName} + '님'">회원이름</h4>

            <div class="user-status" data-bs-toggle="modal" data-bs-target="#gradeModal" style="cursor: pointer;">
                <i class="bi bi-award"></i>
                <span th:text="${member.gradeName}">로얄 등급</span>
            </div>
        </div>
        <!-- Navigation Menu -->
        <nav class="menu-nav">
            <ul class="nav flex-column" role="tablist">
                <li class="nav-item">
                    <a class="nav-link" th:classappend="${activeTab == 'settings' ? 'active' : ''}" th:href="@{/mypage/settings}">
                        <i class="bi bi-gear"></i>
                        <span>내 정보 수정</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" th:classappend="${activeTab == 'orders' ? 'active' : ''}" th:href="@{/mypage/orders}">
                        <i class="bi bi-box-seam"></i>
                        <span>주문내역</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" th:classappend="${activeTab == 'wishlist' ? 'active' : ''}" th:href="@{/mypage/wishlist}">
                        <i class="bi bi-heart"></i>
                        <span>위시리스트</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" th:classappend="${activeTab == 'reviews' ? 'active' : ''}" th:href="@{/mypage/reviews}">
                        <i class="bi bi-star"></i>
                        <span>리뷰</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" th:classappend="${activeTab == 'addresses' ? 'active' : ''}" th:href="@{/mypage/addresses}">
                        <i class="bi bi-geo-alt"></i>
                        <span>주소록</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" th:classappend="${activeTab == 'points' ? 'active' : ''}" th:href="@{/mypage/points}">
                        <i class="bi bi-cash-stack"></i>
                        <span>포인트 내역</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" th:classappend="${activeTab == 'coupons' ? 'active' : ''}" th:href="@{/mypage/coupons}">
                        <i class="bi bi-ticket-perforated"></i>
                        <span>쿠폰함</span>
                    </a>
                </li>
            </ul>

            <div class="menu-footer">
                <a href="#" class="logout-link">
                    <i class="bi bi-box-arrow-right"></i>
                    <span>로그아웃</span>
                </a>
            </div>
        </nav>
    </div>
</th:block>

<!-- Grade Modal Fragment -->
<th:block xmlns:th="http://www.thymeleaf.org" th:fragment="grade_modal">
    <div class="modal fade" id="gradeModal" tabindex="-1" aria-labelledby="gradeModalLabel" aria-hidden="true"
         data-bs-backdrop="true" data-bs-keyboard="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="gradeModalLabel">등급 정보</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <ul class="list-group"
                        th:if="${member.grades != null and !member.grades.isEmpty()}">

                        <li class="list-group-item d-flex justify-content-between align-items-center"
                            th:each="grade : ${member.grades}">
                            <div>
                                <!-- Grade name -->
                                <strong th:text="${grade.gradeName}">GOLD</strong><br>

                                <!-- Criterion price -->
                                <small>
                                    기준 금액:
                                    <span th:text="${grade.criterionPrice}">100000</span> 원
                                </small>
                            </div>

                            <!-- 할인률 / 적립률 등 -->
                            <span th:text="${grade.pointRate * 100} + '%'">5%</span>
                        </li>
                    </ul>

                    <p class="text-muted"
                       th:if="${member.grades == null or member.grades.isEmpty()}">
                        등록된 등급 정보가 없습니다.
                    </p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>
</th:block>
